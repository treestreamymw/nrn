

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Optimization &mdash; NEURON  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Miscellaneous" href="misc.html" />
    <link rel="prev" title="Impedance" href="impedance.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> NEURON
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Building:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cmake_doc/index.html">NEURON CMake Build</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../py_doc/index.html">NEURON Python documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">NEURON HOC documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#quick-links">Quick Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#basic-programming">Basic Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#model-specification">Model Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#simulation-control">Simulation Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#visualization">Visualization</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#analysis">Analysis</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../programmatic.html">Programmatic Analysis Tools</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="impedance.html">Impedance</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Optimization</a></li>
<li class="toctree-l4"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guitools.html">GUI Analysis Tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Python tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rxd-tutorials/index.html">Python RXD tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../scm/index.html">NEURON SCM and Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/index.html">NEURON Development topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doxygen.html">C/C++ API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NEURON</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">NEURON HOC documentation</a> &raquo;</li>
        
          <li><a href="../programmatic.html">Programmatic Analysis Tools</a> &raquo;</li>
        
      <li>Optimization</li>
    
    
<li class="wy-breadcrumbs-aside">
    
        <a href="/nrn/py_doc/analysis/programmatic/optimization.html" > Switch to Python</a>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/new_doc/analysis/programmatic/optimization.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
</li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><a href="#attr_praxis" title="Link to this definition">attr_praxis</a> &middot; <a href="#fit_praxis" title="Link to this definition">fit_praxis</a> &middot; <a href="#pval_praxis" title="Link to this definition">pval_praxis</a> &middot; <a href="#stop_praxis" title="Link to this definition">stop_praxis</a></p><div class="section" id="optimization">
<h1>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="fit_praxis">
<code class="descname">fit_praxis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fit_praxis" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">=</span> <span class="pre">fit_praxis(n,</span> <span class="pre">&quot;funname&quot;,</span> <span class="pre">&amp;x[0])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">=</span> <span class="pre">fit_praxis(n,</span> <span class="pre">&quot;funname&quot;,</span> <span class="pre">Vector)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">=</span> <span class="pre">fit_praxis(...,</span> <span class="pre">...,</span> <span class="pre">...,</span> <span class="pre">&quot;after</span> <span class="pre">quad</span> <span class="pre">statement&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">min</span> <span class="pre">=</span> <span class="pre">fit_praxis(efun_as_python_callable,</span> <span class="pre">hoc_vector)</span></code></p>
</dd>
<dt>Description:</dt><dd><p>This is the principal axis method for minimizing a function. See praxis.c
in the scopmath library.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">n</span> <span class="pre">&lt;</span> <span class="pre">20</span></code></dt><dd>is the number of parameters to vary (number
of arguments to <em>funname</em>).</dd>
<dt><em>funname</em></dt><dd>the name of the function to minimize, eg. least square difference between model and data.
The funname must take two arguments, the first arg, <code class="docutils literal notranslate"><span class="pre">$1</span></code>,
is the number of elements in second arg vector, <code class="docutils literal notranslate"><span class="pre">$&amp;2</span></code>. The ith index of the
vector is given by <code class="docutils literal notranslate"><span class="pre">$&amp;2[i]</span></code>.</dd>
<dt><em>x</em></dt><dd>is a double vector of at least length <em>n</em>. Prior to the call set
it to a guess of the parameter values. On return it contains the
values of the args that minimize <code class="docutils literal notranslate"><span class="pre">funname()</span></code>.</dd>
</dl>
<p><em>funname</em> may be either
an interpreted hoc function or a compiled NMODL function.</p>
<p>If the variable stoprun is set to 1 during a call to fit_praxis, it will
return immediately (when the current call to  funname returns) with
a return value and varx values set to the best minimum found so far. Use
<a class="reference internal" href="../../../py_doc/analysis/programmatic/optimization.html#stop_praxis" title="stop_praxis"><code class="xref py py-func docutils literal notranslate"><span class="pre">stop_praxis()</span></code></a> to stop after finishing the current principal axis calculation.</p>
<p>The fourth argument, if present, specifies a statement to be executed at
the end of each principal axis evaluation.</p>
<p>If the third argument is a Vector, then that style is used to specify
the initial starting point and return the final value. However the
function is still called with second arg as a pointer into a double array.</p>
<p>The Python callable form uses a Python Callable as the function to
minimize and it must take a single hoc Vector argument specifying the
values of the parameters for use in evaluation the function. On entry to
fit_praxis the Vector specifies the number of parameters and the
parameter starting values. On return the vector contains the values of
parameters which generated the least minimum found so far.</p>
<p>Hoc example: minimize <code class="docutils literal notranslate"><span class="pre">(x+y</span> <span class="pre">-</span> <span class="pre">5)^2</span> <span class="pre">+</span> <span class="pre">5*((x-y)</span> <span class="pre">-</span> <span class="pre">15)^2</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>objref vec
vec = new Vector(2) // vec.x[0] is x, vec.x[1] is y
func efun() {local x, y
  x = $&amp;2[0]  y = $&amp;2[1]
  return (x+y - 5)^2 + 5*(x-y - 15)^2
}
attr_praxis(1e-5, .5, 0)
e = fit_praxis(vec.size(), &quot;efun&quot;, vec)
printf(&quot;e=%g x=%g y=%g\n&quot;, e, vec.x[0], vec.x[1])

objref paxis
paxis = new Vector()
for i=0, 1 {
  pval = pval_praxis(i, paxis)
  printf(&quot;%d  %10g      %10g %10g\n&quot;, i, pval, paxis.x[0], paxis.x[1])
}
</pre></div>
</div>
<p>Python example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from neuron import h
v = h.Vector(2)
def efun(v):
  return (v.x[0]+v.x[1] - 5)**2 + 5*(v.x[0]-v.x[1] - 15)**2
h.attr_praxis(1e-5, .5, 0)
e = h.fit_praxis(efun, v)
print &quot;e=%g x=%g y=%g\n&quot;%(e, v.x[0], v.x[1])
</pre></div>
</div>
</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Up to version 4.0.1, the arguments to <em>funname</em> were an explicit
list of <em>n</em> arguments. ie <code class="docutils literal notranslate"><span class="pre">numarg()==n</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../../py_doc/analysis/programmatic/optimization.html#attr_praxis" title="attr_praxis"><code class="xref py py-func docutils literal notranslate"><span class="pre">attr_praxis()</span></code></a>, <a class="reference internal" href="../../../py_doc/analysis/programmatic/optimization.html#stop_praxis" title="stop_praxis"><code class="xref py py-func docutils literal notranslate"><span class="pre">stop_praxis()</span></code></a>, <a class="reference internal" href="../../../py_doc/analysis/programmatic/optimization.html#pval_praxis" title="pval_praxis"><code class="xref py py-func docutils literal notranslate"><span class="pre">pval_praxis()</span></code></a></p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="attr_praxis">
<code class="descname">attr_praxis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#attr_praxis" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">attr_praxis(tolerance,</span> <span class="pre">maxstepsize,</span> <span class="pre">printmode)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">previous_index</span> <span class="pre">=</span> <span class="pre">attr_praxis(mcell_ran4_index)</span></code></p>
</dd>
<dt>Description:</dt><dd><p>Set the attributes of the praxis method. This must be called before
the first call to <a class="reference internal" href="../../../py_doc/analysis/programmatic/optimization.html#fit_praxis" title="fit_praxis"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_praxis()</span></code></a>.</p>
<dl class="docutils">
<dt>tolerance</dt><dd>praxis attempt to return f(x) such that if x0 is the true
local minimum then <code class="docutils literal notranslate"><span class="pre">norm(x-x0)</span> <span class="pre">&lt;</span> <span class="pre">tolerance</span></code></dd>
<dt>maxstepsize</dt><dd>should be set to about the maximum distance from
initial guess to the minimum.</dd>
<dt>printmode=0</dt><dd>no printing</dd>
<dt>printmode=1,2,3</dt><dd>more and more verbose</dd>
</dl>
<p>The single argument form causes praxis to pick its random numbers from
the the mcellran4 generator beginning at the specified index. This
allows reproducible fitting. The return value is the previously picked
index. (see <a class="reference internal" href="../../../py_doc/programming/math/mcran4.html#mcell_ran4" title="mcell_ran4"><code class="xref py py-func docutils literal notranslate"><span class="pre">mcell_ran4()</span></code></a>)</p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pval_praxis">
<code class="descname">pval_praxis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pval_praxis" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">pval</span> <span class="pre">=</span> <span class="pre">pval_praxis(i)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">pval</span> <span class="pre">=</span> <span class="pre">pval_praxis(i,</span> <span class="pre">&amp;paxis[0])</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">pval</span> <span class="pre">=</span> <span class="pre">pval_praxis(i,</span> <span class="pre">Vector)</span></code></p>
</dd>
<dt>Description:</dt><dd>Return the ith principal value. If the second argument is present, <code class="docutils literal notranslate"><span class="pre">pval_praxis</span></code> also fills
the vector with the ith principal axis.</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="stop_praxis">
<code class="descname">stop_praxis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stop_praxis" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">stop_praxis()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">stop_praxis(i)</span></code></p>
</dd>
<dt>Description:</dt><dd>Set a flag in the praxis function that will cause it to stop after
it finishes the current (or ith subsequent)
principal axis calculation. If this function
is called before <a class="reference internal" href="../../../py_doc/analysis/programmatic/optimization.html#fit_praxis" title="fit_praxis"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_praxis()</span></code></a>, then praxis will do a single
(or i) principal axis calculation and then exit.</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="misc.html" class="btn btn-neutral float-right" title="Miscellaneous" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="impedance.html" class="btn btn-neutral float-left" title="Impedance" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Duke, Yale and the Blue Brain Project

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>