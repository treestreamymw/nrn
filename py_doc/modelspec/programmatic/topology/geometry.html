

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Conceptual Overview of Sections &mdash; NEURON  documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Section and Segment Selection" href="secspec.html" />
    <link rel="prev" title="Topology" href="../topology.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> NEURON
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Building:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../cmake_doc/index.html">NEURON CMake Build</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">NEURON Python documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#quick-links">Quick Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#basic-programming">Basic Programming</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html#model-specification">Model Specification</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../guitools.html">Model Specification GUI Tools</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../programmatic.html">Programmatic Model Specification</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../topology.html">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ions.html">Ions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechanisms.html">Dynamics (Channels, etc…)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../rxd.html">Basic Reaction-Diffusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../network.html">Networks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../electrod.html">Electrode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mechtype.html">MechanismType</a></li>
<li class="toctree-l4"><a class="reference internal" href="../obsoletestimuli.html">Obsolete Stimuli</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#simulation-control">Simulation Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#visualization">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#analysis">Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../new_doc/index.html">NEURON HOC documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Python tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../rxd-tutorials/index.html">Python RXD tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../scm/index.html">NEURON SCM and Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/index.html">NEURON Development topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../doxygen.html">C/C++ API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">NEURON</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">NEURON Python documentation</a> &raquo;</li>
        
          <li><a href="../../programmatic.html">Programmatic Model Specification</a> &raquo;</li>
        
          <li><a href="../topology.html">Topology</a> &raquo;</li>
        
      <li>Conceptual Overview of Sections</li>
    
    
<li class="wy-breadcrumbs-aside">
    
        <a href="/nrn/new_doc/modelspec/programmatic/topology/geometry.html" > Switch to HOC</a>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/py_doc/modelspec/programmatic/topology/geometry.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
</li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p><a href="#arc3d" title="Link to this definition">arc3d</a> &middot; <a href="#area" title="Link to this definition">area</a> &middot; <a href="#define_shape" title="Link to this definition">define_shape</a> &middot; <a href="#diam" title="Link to this definition">diam</a> &middot; <a href="#diam3d" title="Link to this definition">diam3d</a> &middot; <a href="#diam_changed" title="Link to this definition">diam_changed</a> &middot; <a href="#distance" title="Link to this definition">distance</a> &middot; <a href="#getSpineArea" title="Link to this definition">getSpineArea</a> &middot; <a href="#L" title="Link to this definition">L</a> &middot; <a href="#n3d" title="Link to this definition">n3d</a> &middot; <a href="#pt3dadd" title="Link to this definition">pt3dadd</a> &middot; <a href="#pt3dchange" title="Link to this definition">pt3dchange</a> &middot; <a href="#pt3dclear" title="Link to this definition">pt3dclear</a> &middot; <a href="#pt3dconst" title="Link to this definition">pt3dconst</a> &middot; <a href="#pt3dinsert" title="Link to this definition">pt3dinsert</a> &middot; <a href="#pt3dremove" title="Link to this definition">pt3dremove</a> &middot; <a href="#pt3dstyle" title="Link to this definition">pt3dstyle</a> &middot; <a href="#Ra" title="Link to this definition">Ra</a> &middot; <a href="#ri" title="Link to this definition">ri</a> &middot; <a href="#setSpineArea" title="Link to this definition">setSpineArea</a> &middot; <a href="#spine3d" title="Link to this definition">spine3d</a> &middot; <a href="#x3d" title="Link to this definition">x3d</a> &middot; <a href="#y3d" title="Link to this definition">y3d</a> &middot; <a href="#z3d" title="Link to this definition">z3d</a></p><div class="section" id="conceptual-overview-of-sections">
<span id="geometry-section"></span><span id="geometry"></span><h1>Conceptual Overview of Sections<a class="headerlink" href="#conceptual-overview-of-sections" title="Permalink to this headline">¶</a></h1>
<p>Sections are unbranched lengths of continuous cable connected together to form
a neuron. Sections can be connected to form
any tree-shaped structure but loops are not permitted. (You may, however,
develop membrane mechanisms, such as electrical gap junctions
which do not have the loop restriction. But be aware that the electrical
current flows through such connections are calculated by a modified euler
method instead of the more numerically robust fully implicit/crank-nicholson
methods)</p>
<p>Do not confuse sections with segments. Sections are divided into segments
of equal length for numerical simulation purposes (see <a class="reference internal" href="../topology.html#Section.nseg" title="Section.nseg"><code class="xref py py-data docutils literal notranslate"><span class="pre">Section.nseg</span></code></a>).
NEURON uses segments to represent the electrical circuit shown below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>          Ra
o/`--o--&#39;\/\/`--o--&#39;\/\/`--o--&#39;\/\/`--o--&#39;\o v
     |          |          |          |
    ---        ---        ---        ---
   |   |      |   |      |   |      |   |
    ---        ---        ---        ---
     |          |          |          |
-------------------------------------------- ground
</pre></div>
</div>
<p>Such segments are similar to
compartments in compartmental modeling programs.</p>
<hr class="docutils" />
<div class="section" id="geometry-geometry">
<span id="id1"></span><h2>Geometry<a class="headerlink" href="#geometry-geometry" title="Permalink to this headline">¶</a></h2>
<p>Section geometry is used to compute the area and axial resistance of each segment.</p>
<p>There are two ways to specify section geometry:</p>
<ol class="arabic simple">
<li>The stylized method simply specifies parameters for length and diameter.</li>
<li>The 3-D method specifies
a section’s shape, orientation, and location in three dimensions.</li>
</ol>
<p>Choose the stylized method if the notions of cable length and diameter
are authoritative and where 3-d shape is irrelevant. For plotting purposes,
length and diameter will be used to generate 3-d info automatically for
a stylized straight cylinder. (see <a class="reference internal" href="#define_shape" title="define_shape"><code class="xref py py-func docutils literal notranslate"><span class="pre">define_shape()</span></code></a>)</p>
<p>Choose the 3-D method if the shape comes from 3-d reconstruction data
or if your 3-d visualization is paramount. This method makes the 3-d info
authoritative and automatically
determines the abstract cable’s length and diameter.
With this method, you may change a section’s length/diameter only by
changing it’s 3-d info. (but see <a class="reference internal" href="#pt3dconst" title="pt3dconst"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dconst()</span></code></a>)</p>
<div class="section" id="stylized-specification-of-geometry">
<h3>Stylized specification of geometry<a class="headerlink" href="#stylized-specification-of-geometry" title="Permalink to this headline">¶</a></h3>
<p>For simulations one needs to specify L, nseg, diam, Ra, and connectivity.</p>
<dl class="docutils">
<dt>section.L</dt><dd>For each section, L is the length of the entire section in microns.</dd>
<dt>section.nseg</dt><dd>The section is divided into nseg compartments of length L/nseg.
Membrane potential will be computed at the ends of the section and the
middle of each compartment.</dd>
<dt>seg.diam</dt><dd>The diameter in microns.
Note that diam is a range variable and
therefore must be respecified whenever <a class="reference internal" href="../../../../new_doc/modelspec/programmatic/topology.html#nseg" title="nseg"><code class="xref py py-data docutils literal notranslate"><span class="pre">nseg</span></code></a> is changed.</dd>
<dt>section.Ra</dt><dd>Axial resistivity in ohm-cm.</dd>
<dt>connectivity</dt><dd>This is established with the <a class="reference internal" href="../../../../new_doc/modelspec/programmatic/topology.html#keyword-connect"><span class="std std-ref">connect</span></a> command and defines the
parent of the section, which end of the section
is attached to the parent, and where on the parent the
attachment takes place. To avoid confusion, it is best to attach the
0 end of a section to the 1 end of its parent.</dd>
</dl>
<p>In the stylized specification, the shape model used for a section is
a sequence of right circular cylinders of length, L/nseg, with diameter
given by the diam range variable at the center of each segment.
The area of a segment is PI*diam*L/nseg (micron2) and the half-segment axial
resistance is <code class="docutils literal notranslate"><span class="pre">.01*sec.Ra*(L/2/sec.nseg)/(PI*(seg.diam/2)^2)</span></code>. The .01 factor is necessary
to convert ohm-cm micron/micron2 to MegOhms. Ends of cylinders are not
counted in the area and, in fact, the areas are very close to those of
truncated cones as long as the diameter does not change too much.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">sec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;sec&#39;</span><span class="p">)</span>
<span class="n">sec</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">sec</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="c1"># linearly interpolate diameters from 10 to 100</span>
<span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">sec</span><span class="p">:</span>
    <span class="n">seg</span><span class="o">.</span><span class="n">diam</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

<span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">sec</span><span class="o">.</span><span class="n">allseg</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">diam</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">area</span><span class="p">(),</span>
            <span class="n">h</span><span class="o">.</span><span class="n">PI</span> <span class="o">*</span> <span class="n">seg</span><span class="o">.</span><span class="n">diam</span> <span class="o">*</span> <span class="n">sec</span><span class="o">.</span><span class="n">L</span> <span class="o">/</span> <span class="n">sec</span><span class="o">.</span><span class="n">nseg</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">ri</span><span class="p">(),</span>
            <span class="mf">0.01</span> <span class="o">*</span> <span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">*</span> <span class="n">sec</span><span class="o">.</span><span class="n">L</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">sec</span><span class="o">.</span><span class="n">nseg</span> <span class="o">/</span> <span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">PI</span> <span class="o">*</span> <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">diam</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0.0 14.5 0.0 4555.30934771 1e+30 0.30279180612
0.05 14.5 4555.30934771 4555.30934771 0.30279180612 0.30279180612
0.15 23.5 7382.74273594 7382.74273594 0.418069266033 0.115277459913
0.25 32.5 10210.1761242 10210.1761242 0.175549154338 0.0602716944253
0.35 41.5 13037.6095124 13037.6095124 0.0972361172657 0.0369644228403
0.45 50.5 15865.0429006 15865.0429006 0.0619274567534 0.0249630339131
0.55 59.5 18692.4762889 18692.4762889 0.0429453733627 0.0179823394497
0.65 68.5 21519.9096771 21519.9096771 0.0315498128871 0.0135674734374
0.75 77.5 24347.3430653 24347.3430653 0.0241667620512 0.0105992886138
0.85 86.5 27174.7764536 27174.7764536 0.0191076887925 0.00850840017866
0.95 95.5 30002.2098418 30002.2098418 0.0154886887932 0.00698028861454
1.0 95.5 0.0 30002.2098418 0.00698028861454 0.00698028861454
</pre></div>
</div>
</div></blockquote>
<p>Note that the area (and length) of the 0,1 terminal ends is equal to 0
and the axial resistance
is the sum of the adjacent half-segment resistances between segment and
parent segment. Such, niceties allow the spatial discretization error to
be proportional to <code class="docutils literal notranslate"><span class="pre">(1/nseg)^2</span></code>. However, for second order correctness,
all point processes must be located at the center of the segments or at the
ends and all branches should be connected at the ends or centers of segments.
Note that if one increases nseg by a factor of 3, old centers are preserved.</p>
<p>For single compartment simulations it is most convenient to choose
a membrane area of 100 micron<sup>2</sup> so that point process currents (nanoamps)
are equivalent to density currents (milliamps/cm<sup>2</sup>).</p>
<p>Also note that a single compartment of length = diameter has the same
effective area as that of a sphere of the same diameter.</p>
<dl class="docutils">
<dt>Example:</dt><dd><p>The following example demonstrates the automatic 3-d shape construction.
The root section “a” is drawn with it’s 0 end (left) at the origin and is colored
red.</p>
<p>Sections connected to its 1 end (sections b, c, d)
get drawn from left to right. Sections
descended from the 0 end (section e) of the root get drawn from right to left.</p>
<p>Especially note the diameter pattern of section c whose “1” end is connected
to the “b” parent. You don’t have to understand this if you always connect
the “0” end to the parent.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">gui</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]]</span>
<span class="n">b</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># connect the 1 end of c to the 1 end of b</span>
<span class="n">d</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># connect the 0 end of e to the 0 end of a</span>
<span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="n">h</span><span class="o">.</span><span class="n">allsec</span><span class="p">():</span>
    <span class="n">sec</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">sec</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">sec</span><span class="p">:</span>
        <span class="n">seg</span><span class="o">.</span><span class="n">diam</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Shape</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="n">a</span><span class="p">)</span> <span class="c1"># color section &quot;a&quot; red</span>
<span class="n">h</span><span class="o">.</span><span class="n">topology</span><span class="p">()</span>
<span class="n">h</span><span class="o">.</span><span class="n">finitialize</span><span class="p">()</span>
<span class="k">for</span> <span class="n">sec</span> <span class="ow">in</span> <span class="n">h</span><span class="o">.</span><span class="n">allsec</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sec</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sec</span><span class="o">.</span><span class="n">n3d</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">: (</span><span class="si">%g</span><span class="s1">, </span><span class="si">%g</span><span class="s1">, </span><span class="si">%g</span><span class="s1">; </span><span class="si">%g</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sec</span><span class="o">.</span><span class="n">x3d</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">sec</span><span class="o">.</span><span class="n">y3d</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">sec</span><span class="o">.</span><span class="n">z3d</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">sec</span><span class="o">.</span><span class="n">diam3d</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
</pre></div>
</div>
<img alt="../../../../_images/geometry1.png" class="align-center" src="../../../../_images/geometry1.png" />
<p>If you change the diameter or length, the Shape instances are
automatically redrawn or when <a class="reference internal" href="../../../visualization/notify.html#doNotify" title="doNotify"><code class="xref py py-func docutils literal notranslate"><span class="pre">doNotify()</span></code></a> is called.
Segment area and axial resistance will be automatically recomputed prior
to their use.</p>
<p>Under some circumstances, involving nonlinearly varying diameters across
a section,
at first sight surprising results can occur
when the stylized method is used and a Shape instance is created.
This is because under a define_shape() with no pre-existing
3-d points in a section, a number of 3-d points is created equal to
the number of segments plus the end areas. When 3-d points exist,
they determine the calculation of L, diam, area, and ri. Thus diam
can change slightly merely due to shape creation. When
L and diam are changed, there is first a change to the 3-d points and
then L and diam are updated to reflect the actual values of these
3-d points. Due to multiple interpolation effects, specifying a nonlinearly
varying diam will, in general, not give exactly the same diameter values as the
case where no 3-d information exists. This effect is illustrated in the
following example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">gui</span>

<span class="k">def</span> <span class="nf">pr</span><span class="p">(</span><span class="n">nseg</span><span class="p">):</span>
    <span class="n">sec</span><span class="o">.</span><span class="n">pt3dclear</span><span class="p">()</span>
    <span class="n">sec</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="n">nseg</span>
    <span class="n">setup_diam</span><span class="p">()</span>
    <span class="n">h</span><span class="o">.</span><span class="n">define_shape</span><span class="p">()</span>
    <span class="n">print_stats</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">setup_diam</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">sec</span><span class="p">:</span>
        <span class="n">seg</span><span class="o">.</span><span class="n">diam</span> <span class="o">=</span> <span class="mi">20</span> <span class="k">if</span> <span class="mf">0.34</span> <span class="o">&lt;=</span> <span class="n">seg</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mf">0.66</span> <span class="k">else</span> <span class="mi">10</span>

<span class="k">def</span> <span class="nf">print_stats</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">sec</span><span class="o">.</span><span class="n">allseg</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1"> </span><span class="si">%g</span><span class="s1"> </span><span class="si">%g</span><span class="s1"> </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">sec</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">diam</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">area</span><span class="p">(),</span> <span class="n">seg</span><span class="o">.</span><span class="n">ri</span><span class="p">()))</span>

<span class="n">h</span><span class="o">.</span><span class="n">xpanel</span><span class="p">(</span><span class="s2">&quot;change nseg&quot;</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">xradiobutton</span><span class="p">(</span><span class="s2">&quot;nseg = 3&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">h</span><span class="o">.</span><span class="n">xradiobutton</span><span class="p">(</span><span class="s2">&quot;nseg = 11&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">h</span><span class="o">.</span><span class="n">xradiobutton</span><span class="p">(</span><span class="s2">&quot;nseg = 101&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>
<span class="n">h</span><span class="o">.</span><span class="n">xpanel</span><span class="p">()</span>

<span class="n">sec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;sec&#39;</span><span class="p">)</span>
<span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">sec</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">sec</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">setup_diam</span><span class="p">()</span>
<span class="n">print_stats</span><span class="p">()</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Shape</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sec</span><span class="o">.</span><span class="n">n3d</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">: </span><span class="si">%g</span><span class="s1"> </span><span class="si">%g</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">sec</span><span class="o">.</span><span class="n">arc3d</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">sec</span><span class="o">.</span><span class="n">diam3d</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;L= </span><span class="si">%g</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">sec</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="n">print_stats</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../../../_images/geometry2.png" class="align-center" src="../../../../_images/geometry2.png" />
</dd>
</dl>
<p>The difference is that the 3-d points define a series of truncated cones
instead of a series of right circular cylinders. The difference is reduced
with larger nseg. With the stylized method, abrupt
changes in diameter should only take place at the
boundaries of sections if you wish to view shape and also make use of
the fewest possible number of segments. But remember, end area of the
abrupt changes is not calculated. For that, you need an explicit pair
of 3-d points with the same location and different diameters.</p>
</div>
<div class="section" id="d-specification-of-geometry">
<h3>3-D specification of geometry<a class="headerlink" href="#d-specification-of-geometry" title="Permalink to this headline">¶</a></h3>
<p>3-d information for a section is kept in a list of (x,y,z,diam) “points”.
The first point is associated with the end of the section that is connected
to the parent (NB: Not necessarily the 0 end) and the
last point is associated with the opposite end. There must be at least two
points and they should be ordered in terms of monotonically increasing
arc length.</p>
<p>The root section is treated as the origin of the cell with respect to
3-d position.  When any section’s 3-d shape or length changes, all the
sections in the child trees have their 3-d information translated to
correspond to the new position.  So, assuming the soma is the root
section, to translate an entire cell to another location it suffices to
change only the location of the soma.  It will avoid confusion if,
except for good reason, one attaches only the 0 end of a child section
to a parent.  This will ensure that the sec(x).diam as x ranges from 0 to 1
has the same sense as sec.diam3d(i) as i ranges from 0 to sec.n3d()-1.</p>
<p>The shape model used for a section when the pt3d list is non-empty
is that of a sequence of truncated cones in which the pt3d points define
the location and diameter of the ends. From this sequence of points,
the effective area, diameter, and resistance is computed for each segment
via a trapezoidal integration across the segment length. This takes
into account the extra area due to <code class="docutils literal notranslate"><span class="pre">sqrt(dx^2</span> <span class="pre">+</span> <span class="pre">dy^2)</span></code> for fast changing
diameters (even degenerate cones of 0 length can be specified, ie. two
points with same coordinates but different diameters)
but no attempt is made to deal with centroid curvature effects
on the area. Note that the number of 3d points used to describe a shape
has nothing to do with nseg and does not affect simulation speed.
(Although, of course, it does affect how fast one can draw the shape)</p>
<dl class="docutils">
<dt>Example:</dt><dd><p>The following illustrates the notion of the 3-d points as describing
a sequence of cones. Note that the segment area and resistance is
different than the
simplistic calculation used in the stylized method. In this case
the area of the segment has very little to do
with the diameter of the center of the segment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">gui</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>

<span class="n">sec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;sec&#39;</span><span class="p">)</span>
<span class="n">sec</span><span class="o">.</span><span class="n">Ra</span><span class="o">=</span><span class="mi">100</span>
<span class="n">sec</span><span class="o">.</span><span class="n">nseg</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">h</span><span class="o">.</span><span class="n">pt3dclear</span><span class="p">(</span><span class="n">sec</span><span class="o">=</span><span class="n">sec</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">PI</span> <span class="o">*</span> <span class="n">i</span> <span class="o">/</span> <span class="mf">30.</span>
    <span class="n">h</span><span class="o">.</span><span class="n">pt3dadd</span><span class="p">(</span><span class="mi">200</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="p">),</span> <span class="n">sec</span><span class="o">=</span><span class="n">sec</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Shape</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sec</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
<span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">sec</span><span class="o">.</span><span class="n">allseg</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">seg</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">diam</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">area</span><span class="p">(),</span> <span class="n">h</span><span class="o">.</span><span class="n">PI</span> <span class="o">*</span> <span class="n">seg</span><span class="o">.</span><span class="n">diam</span> <span class="o">*</span> <span class="n">sec</span><span class="o">.</span><span class="n">L</span> <span class="o">/</span> <span class="n">sec</span><span class="o">.</span><span class="n">nseg</span><span class="p">,</span>
        <span class="n">seg</span><span class="o">.</span><span class="n">ri</span><span class="p">(),</span>
        <span class="mf">0.01</span> <span class="o">*</span> <span class="n">sec</span><span class="o">.</span><span class="n">Ra</span> <span class="o">*</span> <span class="n">sec</span><span class="o">.</span><span class="n">L</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">sec</span><span class="o">.</span><span class="n">nseg</span> <span class="o">/</span> <span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">PI</span> <span class="o">*</span> <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">diam</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
<img alt="../../../../_images/geometry3.png" class="align-center" src="../../../../_images/geometry3.png" />
<p>Note that at one point the diameter is numerically 0 and
the axial resistance becomes
essentially infinite thus decoupling the adjacent segments. Take care to
avoid constructing spheres with a beginning and ending diameter of 0.
No current
would flow from the end to a connecting section. The end diameter should be
the diameter of the end of the connecting section.</p>
<p>The following loads the pyramidal cell 3-d reconstruction from the demo
directory of your neuron system.
Notice that you can modify the length only if the pt3dconst mode is 0.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">gui</span>
<span class="kn">import</span> <span class="nn">__main__</span>

<span class="n">h</span><span class="o">.</span><span class="n">xopen</span><span class="p">(</span><span class="s2">&quot;$(NEURONHOME)/demo/pyramid.nrn&quot;</span><span class="p">)</span>
<span class="n">mode</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span><span class="o">.</span><span class="n">pt3dconst</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span> <span class="c1"># uses default section from pyramid.nrn</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Shape</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">action</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">sec</span><span class="o">=</span><span class="n">h</span><span class="o">.</span><span class="n">dendrite_1</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
<span class="n">s</span><span class="o">.</span><span class="n">color</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="n">h</span><span class="o">.</span><span class="n">dendrite_1</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>

<span class="n">h</span><span class="o">.</span><span class="n">xpanel</span><span class="p">(</span><span class="s2">&quot;Change Length&quot;</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">xvalue</span><span class="p">(</span><span class="s2">&quot;dendrite_1[8].L&quot;</span><span class="p">,</span> <span class="s2">&quot;dendrite_1[8].L&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># using HOC syntax</span>
                                                  <span class="c1"># to directly access</span>
                                                  <span class="c1"># the length</span>
<span class="n">h</span><span class="o">.</span><span class="n">xcheckbox</span><span class="p">(</span><span class="s2">&quot;Can&#39;t change length&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">__main__</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">),</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="n">h</span><span class="o">.</span><span class="n">pt3dconst</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="n">h</span><span class="o">.</span><span class="n">dendrite_1</span><span class="p">[</span><span class="mi">8</span><span class="p">]))</span>
<span class="n">h</span><span class="o">.</span><span class="n">xpanel</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../../../_images/geometry4.png" class="align-center" src="../../../../_images/geometry4.png" />
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pt3dclear" title="pt3dclear"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dclear()</span></code></a>, <a class="reference internal" href="#pt3dadd" title="pt3dadd"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dadd()</span></code></a>, <a class="reference internal" href="#pt3dconst" title="pt3dconst"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dconst()</span></code></a>, <a class="reference internal" href="#pt3dstyle" title="pt3dstyle"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dstyle()</span></code></a>, <a class="reference internal" href="#n3d" title="n3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">n3d()</span></code></a>, <a class="reference internal" href="#x3d" title="x3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">x3d()</span></code></a>, <a class="reference internal" href="#y3d" title="y3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">y3d()</span></code></a>, <a class="reference internal" href="#z3d" title="z3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">z3d()</span></code></a>, <a class="reference internal" href="#diam3d" title="diam3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">diam3d()</span></code></a>, <a class="reference internal" href="#arc3d" title="arc3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">arc3d()</span></code></a>
<a class="reference internal" href="#getSpineArea" title="getSpineArea"><code class="xref py py-func docutils literal notranslate"><span class="pre">getSpineArea()</span></code></a>, <a class="reference internal" href="#setSpineArea" title="setSpineArea"><code class="xref py py-func docutils literal notranslate"><span class="pre">setSpineArea()</span></code></a>, <a class="reference internal" href="#spine3d" title="spine3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">spine3d()</span></code></a></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#define_shape" title="define_shape"><code class="xref py py-func docutils literal notranslate"><span class="pre">define_shape()</span></code></a>, <a class="reference internal" href="#pt3dconst" title="pt3dconst"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dconst()</span></code></a></p>
</div>
<p>If 3-D shape is not an issue it is sufficient to specify the section variables
L (length in microns),  Ra (axial resistivity in ohm-cm), and the range variable
diam (diameter in microns).</p>
<p>A list of 3-D points with corresponding diameters describes the geometry
of a given section.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="defining-the-3d-shape">
<h1>Defining the 3D Shape<a class="headerlink" href="#defining-the-3d-shape" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="pt3dclear">
<code class="descname">pt3dclear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pt3dclear" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">buffersize</span> <span class="pre">=</span>&#160; <span class="pre">h.pt3dclear(sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">buffersize</span> <span class="pre">=</span>&#160; <span class="pre">h.pt3dclear(buffersize,</span> <span class="pre">sec=section)</span></code></p>
</dd>
<dt>Description:</dt><dd>Destroy the 3d location info in <code class="docutils literal notranslate"><span class="pre">section</span></code>.
With an argument, that amount of space is allocated for storage of
3-d points in that section.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A more object-oriented approach is to use <code class="docutils literal notranslate"><span class="pre">sec.pt3dclear()</span></code> instead.</p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pt3dadd">
<code class="descname">pt3dadd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pt3dadd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">h.pt3dadd(x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">d,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.pt3dadd(xvec,</span> <span class="pre">yvec,</span> <span class="pre">zvec,</span> <span class="pre">dvec,</span> <span class="pre">sec=section)</span></code></p>
</dd>
</dl>
<p>Description:</p>
<blockquote>
<div><p>Add the 3d location and diameter point (or points in the second form)
at the end of the current pt3d
list. Assume that successive additions increase the arc length
monotonically. When pt3d points exist in <code class="docutils literal notranslate"><span class="pre">section</span></code> they are used
to compute <em>diam</em> and <em>L</em>. When <em>diam</em> or <em>L</em> are changed and <code class="docutils literal notranslate"><span class="pre">h.pt3dconst(sec=section)==0</span></code>
the 3-d info is changed to be consistent with the new values of
<em>L</em> and <em>diam</em>. (Note: When <em>L</em> is changed, <code class="docutils literal notranslate"><span class="pre">h.define_shape()</span></code> should be executed
to adjust the 3-d info so that branches appear connected.)
The existence of a spine at this point is signaled
by a negative value for <em>d</em>.</p>
<p>The vectorized form is more efficient than looping over
lists in Python.</p>
</div></blockquote>
<p>Example of vectorized specification:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">gui</span>
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="c1"># compute vectors defining a geometry</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.28</span><span class="p">,</span> <span class="mi">63</span><span class="p">)</span>
<span class="n">xvec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">yvec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">zvec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">dvec</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

<span class="n">dend</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;dend&#39;</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">pt3dadd</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">zvec</span><span class="p">,</span> <span class="n">dvec</span><span class="p">,</span> <span class="n">sec</span><span class="o">=</span><span class="n">dend</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Shape</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../../_images/geometry5.png" class="align-center" src="../../../../_images/geometry5.png" />
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The vectorized form was added in NEURON 7.5.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A more object-oriented approach is to use <code class="docutils literal notranslate"><span class="pre">sec.pt3dadd</span></code> instead.</p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pt3dconst">
<code class="descname">pt3dconst</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pt3dconst" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">h.pt3dconst(0,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.pt3dconst(1,</span> <span class="pre">sec=section)</span></code></p>
</dd>
<dt>Description:</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">pt3dconst</span></code> is set at 0, newly assigned values for <em>d</em> and <em>L</em> will
automatically update pre-existing 3d information.
<code class="docutils literal notranslate"><span class="pre">pt3dconst</span></code> returns its previous state on each call. Its original value is 0.</p>
<p>Note that the <em>diam</em> information transferred to the 3d point information
comes from the current diameter of the segments and does not change
the number of 3d points.  Thus if there are a lot of 3d points the
shape will appear as a string of uniform diameter cylinders each of
length L/nseg. ie. after transfer <code class="docutils literal notranslate"><span class="pre">sec.diam3d(i)</span> <span class="pre">==</span> <span class="pre">sec(sec.arc3d(i)/sec.L).diam</span></code>.
Then, after a call to an internal function such as <code class="docutils literal notranslate"><span class="pre">area()</span></code> or
<code class="docutils literal notranslate"><span class="pre">h.finitialize()</span></code>, the 3d point info will be used to determine the values
of the segment diameters.</p>
<p>Because of the three separate interpolations:
hoc range spec -&gt; segment diameter -&gt; 3d point diam -&gt; segment diameter,
the final values of the segment diameter may be different from the
case where 3d info does not exist.</p>
<p>Because of the surprises noted above, when using 3d points
consider treating them as the authoritative diameter info and set
<code class="docutils literal notranslate"><span class="pre">h.pt3dconst(1,</span> <span class="pre">sec=section)</span></code>.</p>
<p>3d points are automatically generated when one uses
the NEURON Shape class. Experiment with <code class="docutils literal notranslate"><span class="pre">sec.nseg</span></code> and
<code class="docutils literal notranslate"><span class="pre">sec.n3d()</span></code> in order to understand the exact consequences of interpolation.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pt3dstyle" title="pt3dstyle"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dstyle()</span></code></a></p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pt3dstyle">
<code class="descname">pt3dstyle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pt3dstyle" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">style</span> <span class="pre">=</span> <span class="pre">h.pt3dstyle(sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">style</span> <span class="pre">=</span> <span class="pre">h.pt3dstyle(0,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">style</span> <span class="pre">=</span> <span class="pre">h.pt3dstyle(1,</span> <span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">style</span> <span class="pre">=</span> <span class="pre">h.pt3dstyle(1,</span> <span class="pre">_ref_x,</span> <span class="pre">_ref_y,</span> <span class="pre">_ref_z,</span> <span class="pre">sec=section)</span></code></p>
</dd>
<dt>Description:</dt><dd><p>With no args besides the <code class="docutils literal notranslate"><span class="pre">sec=</span></code> keyword, returns 1 if using a logical connection point.</p>
<p>With a first arg of 0, then style is NO logical connection point
and (with <a class="reference internal" href="#pt3dconst" title="pt3dconst"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dconst()</span></code></a> == 0 and <code class="docutils literal notranslate"><span class="pre">h.define_shape()</span></code> is executed)
the 3-d location info is translated so the first 3-d point coincides with
the parent connection location. This is the classical and default behavior.</p>
<p>With a first arg of 1 and x,y,z value arguments, those values are used
to define a logical connection point relative to the first 3-d point.
When <a class="reference internal" href="#pt3dconst" title="pt3dconst"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dconst()</span></code></a> == 0 and define_shape is executed, the 3-d location
info is translated so that the logical connection point coincides
with the parent connection location. Note that logical connection points
have absolutely no effect on the electrical properties of the structure since
they do not affect the length or area of a section.
They are useful mostly for accurate visualization of a dendrite connected
to the large diameter edge of a soma that happens to be far from the
soma centroid. The logical connection point should be set to the location
of the parent centroid connection, i.e. most often the 0.5 location
of the soma. Note, that under translation and scaling,
the relative position between
the logical connection point and the first 3-d point is preserved.</p>
<p>With a first arg of 1 and x,y,z reference arguments, the x,y,z variables
are assigned the values of the logical connection point (if the style
in fact was 1).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pt3dconst" title="pt3dconst"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dconst()</span></code></a>, <a class="reference internal" href="#define_shape" title="define_shape"><code class="xref py py-func docutils literal notranslate"><span class="pre">define_shape()</span></code></a></p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pt3dinsert">
<code class="descname">pt3dinsert</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pt3dinsert" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><code class="docutils literal notranslate"><span class="pre">h.pt3dinsert(i,</span> <span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">diam,</span> <span class="pre">sec=section)</span></code></dd>
<dt>Description:</dt><dd>Insert the point (so it becomes the i’th point) to <code class="docutils literal notranslate"><span class="pre">section</span></code>. If i is equal to
<code class="docutils literal notranslate"><span class="pre">section.n3d()</span></code>, the point is appended (equivalent to <a class="reference internal" href="#pt3dadd" title="pt3dadd"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dadd()</span></code></a>).</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pt3dremove">
<code class="descname">pt3dremove</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pt3dremove" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><code class="docutils literal notranslate"><span class="pre">h.pt3dremove(i,</span> <span class="pre">sec=section)</span></code></dd>
<dt>Description:</dt><dd>Remove the i’th 3D point from <code class="docutils literal notranslate"><span class="pre">section</span></code>.</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="pt3dchange">
<code class="descname">pt3dchange</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pt3dchange" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">h.pt3dchange(i,</span> <span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">diam,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.pt3dchange(i,</span> <span class="pre">diam,</span> <span class="pre">sec=section)</span></code></p>
</dd>
<dt>Description:</dt><dd><p>Change the i’th 3-d point info. If only two args then the second arg
is the diameter and the location is unchanged.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">pt3dchange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">x3d</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">section</span><span class="o">.</span><span class="n">y3d</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">section</span><span class="o">.</span><span class="n">z3d</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">section</span><span class="o">.</span><span class="n">diam3d</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="o">.</span><span class="n">spine3d</span><span class="p">(</span><span class="n">sec</span><span class="o">=</span><span class="n">section</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="n">section</span><span class="o">.</span><span class="n">diam3d</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
             <span class="n">sec</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
</pre></div>
</div>
<p>leaves the pt3d info unchanged.</p>
</dd>
</dl>
</dd></dl>

</div>
<hr class="docutils" />
<div class="section" id="reading-3d-data-from-neuron">
<h1>Reading 3D Data from NEURON<a class="headerlink" href="#reading-3d-data-from-neuron" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="n3d">
<code class="descname">n3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#n3d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">section.n3d()</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.n3d(sec=section)</span></code></p>
</dd>
<dt>Description:</dt><dd>Return the number of 3d locations stored in the <code class="docutils literal notranslate"><span class="pre">section</span></code>. The <code class="docutils literal notranslate"><span class="pre">section.n3d()</span></code> syntax returns an
integer and is generally clearer than the <code class="docutils literal notranslate"><span class="pre">h.n3d(sec=section)</span></code> which returns a float and therefore
has to be cast to an int to use with <code class="docutils literal notranslate"><span class="pre">range</span></code>. The latter form is, however, slightly more efficient
when used with <code class="docutils literal notranslate"><span class="pre">section.push()</span></code> and <code class="docutils literal notranslate"><span class="pre">h.pop_section()</span></code> to set a default section used for many
morphology queries (in which case the sec= would be omitted).</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="x3d">
<code class="descname">x3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#x3d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">section.x3d(i)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.x3d(i,</span> <span class="pre">sec=section)</span></code></p>
</dd>
<dt>Description:</dt><dd>Returns the x coordinate of the ith point in the 3-d list of the
<code class="docutils literal notranslate"><span class="pre">section</span></code> (or in the second form, if no section is specified of
NEURON’s current default section). As with <a class="reference internal" href="#n3d" title="n3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">n3d()</span></code></a>, temporarily
setting the default section is slightly more efficient when dealing
with large numbers of queries about the same section; the tradeoff is
a loss of code clarity.</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#y3d" title="y3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">y3d()</span></code></a>, <a class="reference internal" href="#z3d" title="z3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">z3d()</span></code></a>, <a class="reference internal" href="#arc3d" title="arc3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">arc3d()</span></code></a>, <a class="reference internal" href="#diam3d" title="diam3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">diam3d()</span></code></a></p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="y3d">
<code class="descname">y3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#y3d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">section.y3d(i)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.y3d(i,</span> <span class="pre">sec=section)</span></code></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#x3d" title="x3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">x3d()</span></code></a></p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="z3d">
<code class="descname">z3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#z3d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">section.z3d(i)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.z3d(i,</span> <span class="pre">sec=section)</span></code></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#x3d" title="x3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">x3d()</span></code></a></p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="diam3d">
<code class="descname">diam3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#diam3d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">section.diam3d(i)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.x3d(diam,</span> <span class="pre">sec=section)</span></code></p>
</dd>
<dt>Description:</dt><dd>Returns the diameter of the ith 3d point of <code class="docutils literal notranslate"><span class="pre">section</span></code> (or of
NEURON’s current default if no <code class="docutils literal notranslate"><span class="pre">sec=</span></code> argument is provided).
<code class="docutils literal notranslate"><span class="pre">diam3d(i)</span></code> will always be positive even
if there is a spine at the ith point.</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#spine3d" title="spine3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">spine3d()</span></code></a></p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="arc3d">
<code class="descname">arc3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#arc3d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">section.arc3d(i)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">h.arc3d(i,</span> <span class="pre">sec=section)</span></code></p>
</dd>
<dt>Description:</dt><dd>This is the arc length position of the ith point in the 3d list.
<code class="docutils literal notranslate"><span class="pre">section.arc3d(section.n3d()-1)</span> <span class="pre">==</span> <span class="pre">section.L</span></code></dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="spine3d">
<code class="descname">spine3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#spine3d" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><code class="docutils literal notranslate"><span class="pre">h.spine3d(i,</span> <span class="pre">sec=section)</span></code></dd>
<dt>Description:</dt><dd>Return 0 or 1 depending on whether a spine exists at this point.</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="setSpineArea">
<code class="descname">setSpineArea</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#setSpineArea" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><code class="docutils literal notranslate"><span class="pre">h.setSpineArea(area)</span></code></dd>
<dt>Description:</dt><dd>The area of an average spine in um<sup>2</sup>. <code class="docutils literal notranslate"><span class="pre">setSpineArea</span></code> merely adds to
the total area of a segment.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This value affects all sections on the current compute node.</p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="getSpineArea">
<code class="descname">getSpineArea</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getSpineArea" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><code class="docutils literal notranslate"><span class="pre">h.getSpineArea()</span></code></dd>
<dt>Description:</dt><dd>Return the area of the average spine. This value is the same
for all sections.</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="define_shape">
<code class="descname">define_shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#define_shape" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><code class="docutils literal notranslate"><span class="pre">h.define_shape()</span></code></dd>
<dt>Description:</dt><dd><p>Fill in empty pt3d information with a naive algorithm based on current
values for <em>L</em> and <em>diam</em>. Sections that already have pt3d info are
translated to ensure that their first point is at the same location
as the parent. But see <a class="reference internal" href="#pt3dstyle" title="pt3dstyle"><code class="xref py py-func docutils literal notranslate"><span class="pre">pt3dstyle()</span></code></a> with regard to the use of
a logical connection point if the translation ruins the
visualization.</p>
<p>Note: This may not work right when a branch is connected to
the interior of a parent section <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">1</span></code>,
rather only when it is connected to the parent at 0 or 1.</p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="area">
<code class="descname">area</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#area" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">h.area(x,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">section(x).area()</span></code></p>
</dd>
<dt>Description:</dt><dd><p>Return the area (in square microns) of the segment <code class="docutils literal notranslate"><span class="pre">section(x)</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">section(0).area()</span></code> and <code class="docutils literal notranslate"><span class="pre">section(1).area()</span></code> = 0</p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="ri">
<code class="descname">ri</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ri" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">h.ri(x,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">section(x).ri()</span></code></p>
</dd>
<dt>Description:</dt><dd>Return the resistance (in megohms) between the center of the segment <code class="docutils literal notranslate"><span class="pre">section(x)</span></code>
and its parent segment. This can be used to compute axial current
given the voltage at two adjacent points. If there is no parent
the “infinite” resistance returned is 1e30.</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">seg</span> <span class="ow">in</span> <span class="n">sec</span><span class="o">.</span><span class="n">allseg</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1"> </span><span class="si">%g</span><span class="s1"> </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">sec</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">area</span><span class="p">(),</span> <span class="n">seg</span><span class="o">.</span><span class="n">ri</span><span class="p">()))</span>
</pre></div>
</div>
<p>will print the arc length, the segment area at that arc length, and the resistance along that length
for the section <code class="docutils literal notranslate"><span class="pre">sec</span></code>.</p>
</div></blockquote>
</dd></dl>

<hr class="docutils" />
<dl class="py function">
<dt id="distance">
<code class="descname">distance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#distance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">h.distance(sec=section)</span></code> or <code class="docutils literal notranslate"><span class="pre">h.distance(0,</span> <span class="pre">x,</span> <span class="pre">sec=section)</span></code> or <code class="docutils literal notranslate"><span class="pre">h.distance(0,</span> <span class="pre">section(x))</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">=</span> <span class="pre">h.distance(x,</span> <span class="pre">sec=section)</span></code> or <code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">=</span> <span class="pre">h.distance(1,</span> <span class="pre">x,</span> <span class="pre">sec=section)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">=</span> <span class="pre">h.distance(segment1,</span> <span class="pre">segment2)</span></code></p>
</dd>
</dl>
<p>Description:</p>
<blockquote>
<div><p>Compute the path distance between two points on a neuron.
If a continuous path does not exist the return value is 1e20.</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">h.distance(sec=section)</span></code></dt><dd>specifies the origin as location 0
of <code class="docutils literal notranslate"><span class="pre">section</span></code></dd>
<dt><code class="docutils literal notranslate"><span class="pre">h.distance(x,</span> <span class="pre">sec=section)</span></code> or <code class="docutils literal notranslate"><span class="pre">h.distance(section(x))</span></code> for 0 &lt;= x &lt;= 1</dt><dd>returns the distance (in microns) from the origin to
<code class="docutils literal notranslate"><span class="pre">section(x)</span></code>.</dd>
</dl>
<p>To overcome the
old initialization restriction, <code class="docutils literal notranslate"><span class="pre">h.distance(0,</span> <span class="pre">x,</span> <span class="pre">sec=section)</span></code>
or the shorter <code class="docutils literal notranslate"><span class="pre">h.distance(0,</span> <span class="pre">section(x))</span></code> can be used to set the
origin. Note that distance is measured from the centers of
segments.</p>
</div></blockquote>
<p>Example:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span>

<span class="n">soma</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;soma&#39;</span><span class="p">)</span>
<span class="n">dend</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;dend&#39;</span><span class="p">)</span>
<span class="n">dend</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">soma</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">soma</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">dend</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">length</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">soma</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">dend</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When subtrees are connected by <a class="reference internal" href="../network/parcon.html#ParallelContext.multisplit" title="ParallelContext.multisplit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ParallelContext.multisplit()</span></code></a> , the
distance function returns 1e20 if the path spans the split location.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Support for the variants of this function using a segment (i.e. with <code class="docutils literal notranslate"><span class="pre">section(x)</span></code>)
was added in NEURON 7.5.
The two segment form requires NEURON 7.7+.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../../visualization/rvarplt.html#RangeVarPlot" title="RangeVarPlot"><code class="xref py py-class docutils literal notranslate"><span class="pre">RangeVarPlot</span></code></a></p>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py data">
<dt id="diam_changed">
<code class="descname">diam_changed</code><a class="headerlink" href="#diam_changed" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><code class="docutils literal notranslate"><span class="pre">h.diam_changed</span> <span class="pre">=</span> <span class="pre">1</span></code></dd>
<dt>Description:</dt><dd><p>Signals the system that the coefficient matrix needs to be
recalculated.</p>
<p>This is not needed since <code class="docutils literal notranslate"><span class="pre">Ra</span></code> is now a section variable
and automatically sets diam_changed whenever any sections Ra is
changed.
Changing diam or any pt3d value will cause it to be set automatically.</p>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The value is automatically reset to 0 when NEURON has recalculated the coefficient matrix,
so reading it may not always produce the result you expect.</p>
<p>If it is important to monitor changes to the diameter, look at the internal variable
<code class="docutils literal notranslate"><span class="pre">diam_change_cnt</span></code> which increments every time <code class="docutils literal notranslate"><span class="pre">h.diam_changed</span></code> is automatically reset to 0:</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neuron</span> <span class="kn">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">gui</span>
<span class="kn">import</span> <span class="nn">neuron</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">diam_change_cnt</span> <span class="o">=</span> <span class="n">neuron</span><span class="o">.</span><span class="n">nrn_dll_sym</span><span class="p">(</span><span class="s1">&#39;diam_change_cnt&#39;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diam_changed</span><span class="p">,</span> <span class="n">diam_change_cnt</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>    <span class="c1"># 1 0</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">Section</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diam_changed</span><span class="p">,</span> <span class="n">diam_change_cnt</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>    <span class="c1"># 1 0</span>

<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diam_changed</span><span class="p">,</span> <span class="n">diam_change_cnt</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>    <span class="c1"># 0 1</span>

<span class="n">s</span><span class="o">.</span><span class="n">diam</span> <span class="o">=</span> <span class="mi">42</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diam_changed</span><span class="p">,</span> <span class="n">diam_change_cnt</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>    <span class="c1"># 1 1</span>

<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">diam_changed</span><span class="p">,</span> <span class="n">diam_change_cnt</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>    <span class="c1"># 1 2</span>
</pre></div>
</div>
</div>
</dd></dl>

<hr class="docutils" />
<dl class="py data">
<dt id="L">
<code class="descname">L</code><a class="headerlink" href="#L" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">section.L</span></code></p>
<blockquote>
<div>Length of a section in microns.</div></blockquote>
</dd></dl>

<hr class="docutils" />
<dl class="py data">
<dt id="diam">
<code class="descname">diam</code><a class="headerlink" href="#diam" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">section(x).diam</span></code></p>
<blockquote>
<div>Diameter range variable of a section in microns.</div></blockquote>
</dd></dl>

<hr class="docutils" />
<dl class="py data">
<dt id="Ra">
<code class="descname">Ra</code><a class="headerlink" href="#Ra" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Syntax:</dt><dd><code class="docutils literal notranslate"><span class="pre">section.Ra</span></code></dd>
<dt>Description:</dt><dd><p>Axial resistivity in ohm-cm. This used to be a global variable
so that it was the same for all sections. Now, it is a section
variable and must be set individually for each section. A simple
way to set its value is <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">sec</span> <span class="pre">in</span> <span class="pre">h.allsec():</span> <span class="pre">sec.Ra</span> <span class="pre">=</span> <span class="pre">35.4</span></code></p>
<p>Prior to 1/6/95 the default value for Ra was 34.5. Presently it is
35.4.</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="secspec.html" class="btn btn-neutral float-right" title="Section and Segment Selection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../topology.html" class="btn btn-neutral float-left" title="Topology" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Duke, Yale and the Blue Brain Project

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>